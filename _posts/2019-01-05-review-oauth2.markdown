---
layout: post
title:  "OAuth2 정리"
date:   2019-01-05 00:18:23 +0700
categories: [oauth2]
---
기존 프로젝트에서 사용하는 Spring 버전을 4 에서 5로 업데이트를 하면서, Spring Security 관련 코드 수정에서 어려움을 겪었다. 
OAuth2 관련된 코드를 Reactive Web 에 맞게 변경하는데, 코드의 플로우와 사용하는 용어들이 상당히 낯설었다. 이참에 웹 분야의 인증에 어느 정도 개념을 잡고가야겠다는 생각을 했고, 이제껏 내가 공부한 OAuth2 의 개념에 대해서 첫 번째 포스트로 등록하기로 했다. 
# 배경
### SaaS(Software as a Service) 등장
 - **Twitter, FaceBook, Google** 과 같은 거대 IT 기업들은 자신의 플랫폼에서 제공하는 서비스를 다른 소프트웨어에서도 사용할 수 있는 형태로 제공하는 상호협력 가능한 비즈니스 모델을 만들었다. 이 비즈니스 모델은 업계의 사실상 표준(**De Facto**)이 됬다. 우리가 사용하는 대다수의 모바일 앱들을 보면 구글, 페이스북, 혹은 네이버와 같은 서비스 플랫폼을 통해서 인증을 하고, 해당 플랫폼이 제공하는 서비스를 활용한다.
몇몇 예를 들자면, 달리기앱에서 오늘 달린 거리를 페이스북이나 트위터에 바로 올려서 친구들한테 나의 기록을 보여준다. 소개팅 앱에서 페이스북에서 설정한 개인정보(학교, 취미, 관심분야)를 이용해, 적절한 상대를 매칭해주거나 친구목록을 보고 매칭 상대를 제한하기도 한다. 
### 표준화의 필요성 및 보안 이슈 
 - 그럼 어떻게 구현을 할 것 인가에 대해서 생각해보자. 서비스 제공자 관점과 클라이언트(서비스 사용자) 관점에서 설명해보겠다.
   - 서비스 제공자
     * 클라이언트의 목록이 필요함.
     * 
   - 클라이언트
     * ㄴ
 - 그래서 어플리케이션들이 해당 서비스를 이용해서, 사용자들의 정보를 활용하거나 어플리케이션이ㅡ 
 - 사용자가 서비스 
* 보안 이슈
- ID / PW 
* 
- 새로운 형태의 서비스 제공 방식의 출현으로 인해 어플리케이션이 사용자에게 서비스를 제공해주는 방식이 많이 바꼈다.
- SaaS가 어플리케이션 서비스 방식의 대세로 자리매김을 하면서, 서비스 제공자에 자신을 인증하는 방식의 표준이 필요하게 됬다.
- 어플리케이션이 사용자와 서비스 제공자를 연결해주고, 서비스 제공자는 사용자에게 권한을 허락할 것인지 의사를 확인한다 
- 사용자가 허락하면, 서비스 제공자는 어플리케이션에게 서비스 제공자의 서비스에 접근을 할 수 있는 접근 토큰(방문증)을 발급한다.
- 어플리케이션은 그 뒤로 접근 토큰을 사용해서, 서비스 제공자의 서비스를 정해진 권한 범위내에서 사용할 수 있게 된다.  
- SaaS(Software as a Service) 
- 플랫폼화된 서비스의 등장으로 인해, 어플리케이션이 제공하는 서비스는 플랫폼과 연동하게 됨.
- 예를 들면, 달리기 앱을 통해서 성취한 것을 플랫폼에 공유 할 수 있음. 
- 혹은 플랫폼에 등록된 나의 계정 정보를 통해서 서비스를 제공. 
- 
- 기존 인증 방식의 문제점.
  - 기존에는 API Key 방식으로 인증을 했음. 토큰 방식이 없었을 경우, 직접 ID / PW 를 노출해야됨. 안전하지 못함. 토큰을 들고 있게됨. 
- 인증과 권한의 차이.
- JWT 토큰을 사용한 Session 제거.   
## 용어정리 
- Resource Owner 
- Resource Server
- Client
- Authorization Server 
## Grant Type 
* Authorization Code
* Client Credential
* Password
* Implicit 
* Password

## 결론

